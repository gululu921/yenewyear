<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <title>To å¶ä½³é¢– Â· Happy New Year</title>
    <style>
      /* Reset & base */
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      html,
      body {
        width: 100%;
        height: 100%;
        overflow: hidden;
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "PingFang SC",
          "Microsoft YaHei", sans-serif;
        background: #050007;
        color: #ffd6f0;
      }

      body {
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .scene-root {
        position: relative;
        width: 100%;
        height: 100%;
        max-width: 480px;
        margin: 0 auto;
        overflow: hidden;
        background: radial-gradient(circle at top, #2a002f 0%, #050007 55%, #000000 100%);
      }

      /* å…¬å…±æµ®åŠ¨å°çˆ±å¿ƒ & love */
      .float-layer {
        pointer-events: none;
        position: absolute;
        inset: 0;
        overflow: hidden;
      }

      .float-item {
        position: absolute;
        font-size: 10px;
        animation: floatUp 14s linear infinite;
        text-shadow:
          0 0 4px rgba(255, 190, 230, 0.8),
          0 0 10px rgba(255, 150, 210, 0.7);

        /* åˆ©ç”¨è‡ªå®šä¹‰å±æ€§å®ç°ä»ä¸‹åˆ°ä¸Šé€æ˜åº¦ / é¢œè‰²æ¸å˜ï¼ˆæµ…ç²‰ â†’ æ›´äº®ç²‰ï¼‰ */
        --depth: 0.5; /* 0 = åº•éƒ¨, 1 = é¡¶éƒ¨ */
        opacity: calc(0.12 + var(--depth) * 0.45);
        color: rgb(
          255,
          calc(150 + var(--depth) * 70),
          calc(190 + var(--depth) * 60)
        );
      }

      @keyframes floatUp {
        0% {
          transform: translate3d(0, 110%, 0) scale(0.9);
          opacity: 0;
        }
        10% {
          opacity: 0.4;
        }
        80% {
          opacity: 0.55;
        }
        100% {
          transform: translate3d(0, -10%, 0) scale(1.08);
          opacity: 0;
        }
      }

      /* ä¿¡å°é¡µé¢ */
      .screen {
        position: absolute;
        inset: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        padding: 0 32px;
        transition: opacity 0.6s ease, visibility 0.6s ease, transform 0.6s ease;
      }

      .screen--hidden {
        opacity: 0;
        visibility: hidden;
        transform: translateY(10px) scale(0.98);
        pointer-events: none;
      }

      .screen--active {
        opacity: 1;
        visibility: visible;
        transform: translateY(0) scale(1);
      }

      .envelope {
        position: relative;
        width: 82vw;
        max-width: 360px;
        aspect-ratio: 4 / 3;
        cursor: pointer;
        transform-style: preserve-3d;
        animation: envelopeFloat 4s ease-in-out infinite;
      }

      @keyframes envelopeFloat {
        0%,
        100% {
          transform: translateY(0) scale(1);
        }
        50% {
          transform: translateY(-8px) scale(1.02);
        }
      }

      .env-base {
        position: absolute;
        inset: 0;
        border-radius: 18px;
        background: linear-gradient(135deg, #2b022f, #120015 40%, #2f0228 100%);
        box-shadow:
          0 16px 26px rgba(0, 0, 0, 0.7),
          0 0 30px rgba(255, 73, 168, 0.6);
        overflow: hidden;
      }

      .env-inner {
        position: absolute;
        inset: 10%;
        border-radius: 14px;
        background: radial-gradient(circle at top, #3a013e, #100015);
        border: 1px solid rgba(255, 143, 209, 0.3);
        display: flex;
        align-items: center;
        justify-content: center;
        flex-direction: column;
        color: #ffe4f7;
        text-align: center;
      }

      .env-greetings-main {
        font-size: 20px;
        letter-spacing: 0.16em;
        margin-bottom: 8px;
        text-shadow:
          0 0 10px rgba(255, 166, 225, 0.9),
          0 0 20px rgba(255, 67, 164, 0.9);
      }

      .env-greetings-sub {
        font-size: 13px;
        color: #ffbfe9;
        letter-spacing: 0.2em;
      }

      .env-heart-stamp {
        position: absolute;
        bottom: 10%;
        right: 12%;
        width: 52px;
        height: 52px;
        border-radius: 999px;
        border: 2px solid rgba(255, 189, 232, 0.9);
        display: flex;
        align-items: center;
        justify-content: center;
        color: #ff9bdc;
        font-size: 20px;
        background: radial-gradient(circle at top, #520331, #1a000e);
        box-shadow:
          0 0 10px rgba(255, 141, 219, 0.9),
          0 0 22px rgba(255, 106, 184, 0.8);
        animation: stampPulse 1.6s ease-in-out infinite;
      }

      @keyframes stampPulse {
        0%,
        100% {
          transform: scale(1);
        }
        50% {
          transform: scale(1.08);
        }
      }

      .env-open-tip {
        position: absolute;
        bottom: -26px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 12px;
        color: #ffb6ef;
        letter-spacing: 0.18em;
        white-space: nowrap;
        display: flex;
        align-items: center;
        gap: 0.3em;
        animation: tipBlink 1.6s ease-in-out infinite;
      }

      .env-open-tip-dot {
        width: 5px;
        height: 5px;
        border-radius: 50%;
        background: #ff8ad4;
        box-shadow: 0 0 10px rgba(255, 132, 219, 0.9);
      }

      @keyframes tipBlink {
        0%,
        100% {
          opacity: 0.4;
        }
        50% {
          opacity: 1;
        }
      }

      /* èƒŒæ™¯ç«–æ’å­—ç¬¦é›¨ */
      .rain-layer {
        position: absolute;
        inset: 0;
        overflow: hidden;
        pointer-events: none;
        mix-blend-mode: screen;
      }

      .column {
        position: absolute;
        top: -140%;
        width: 10px;
        color: rgba(236, 176, 193, 0.6);
        opacity: 0.28;
        font-size: 10px;
        letter-spacing: 3px;
        text-align: center;
        writing-mode: vertical-rl;
        text-orientation: mixed;
        animation-name: fall;
        animation-timing-function: linear;
        animation-iteration-count: infinite;
        text-shadow:
          0 0 8px rgba(255, 170, 230, 0.9),
          0 0 16px rgba(255, 110, 210, 0.85);
      }

      @keyframes fall {
        0% {
          transform: translate3d(0, -20%, 0);
          opacity: 0;
        }
        10% {
          opacity: 0.5;
        }
        80% {
          opacity: 0.7;
        }
        100% {
          transform: translate3d(0, 150%, 0);
          opacity: 0;
        }
      }

      /* æ‰“å¼€å¥–å¡åçš„ä¸­å¿ƒå†…å®¹ */
      .center {
        position: absolute;
        inset: 0;
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        padding-bottom: 8vh;
      }

      /* çˆ±å¿ƒï¼ˆSVG å¤–å‘å…‰ + è·³åŠ¨ï¼‰ */
      .heart-wrapper {
        position: relative;
        width: 70vw;
        max-width: 360px;
        aspect-ratio: 1 / 1;
        filter: drop-shadow(0 0 12px rgba(255, 92, 178, 0.8))
          drop-shadow(0 0 24px rgba(255, 92, 178, 0.5));
        animation: heartbeat 2.4s ease-in-out infinite;
      }

      @keyframes heartbeat {
        0%,
        20%,
        100% {
          transform: scale(1);
        }
        10% {
          transform: scale(1.14);
        }
        35% {
          transform: scale(1.06);
        }
        50% {
          transform: scale(1.18);
        }
        70% {
          transform: scale(1.02);
        }
      }

      .heart-path {
        fill: none;
        stroke: #ff7fbc;
        stroke-width: 5;
        stroke-linecap: round;
        stroke-linejoin: round;
        stroke-dasharray: 520;
        stroke-dashoffset: 520;
        animation:
          draw 3.2s ease-in-out forwards,
          glow 2.8s ease-in-out infinite 3.2s;
      }

      @keyframes draw {
        0% {
          stroke-dashoffset: 520;
        }
        100% {
          stroke-dashoffset: 0;
        }
      }

      @keyframes glow {
        0%,
        100% {
          stroke-width: 4;
          stroke: #ff99cf;
        }
        50% {
          stroke-width: 6;
          stroke: #ffd3f0;
        }
      }

      /* æ²¿ç€çˆ±å¿ƒè·¯å¾„æ¼‚æµ®çš„å°çˆ±å¿ƒç²’å­ï¼ˆä½¿ç”¨ä¼ªå…ƒç´ æ¨¡æ‹Ÿï¼‰ */
      .heart-wrapper::before,
      .heart-wrapper::after {
        content: "â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤ â¤";
        position: absolute;
        inset: 12%;
        color: #ff8ac8;
        font-size: 10px;
        text-align: center;
        opacity: 0.9;
        mix-blend-mode: screen;
        filter: blur(0.3px);
        animation: twinkle 5s linear infinite;
        transform-origin: center;
      }

      .heart-wrapper::after {
        opacity: 0.6;
        color: #ffc1e6;
        filter: blur(1px);
        animation-duration: 7s;
        animation-direction: reverse;
      }

      @keyframes twinkle {
        0% {
          transform: rotate(0deg) scale(0.95);
          opacity: 0.7;
        }
        50% {
          transform: rotate(3deg) scale(1.08);
          opacity: 1;
        }
        100% {
          transform: rotate(0deg) scale(0.96);
          opacity: 0.7;
        }
      }

      /* ä»å¤§çˆ±å¿ƒä¸­å¿ƒâ€œè¹¦å‡ºâ€çš„å°çˆ±å¿ƒç²’å­ */
      .heart-pop {
        position: absolute;
        left: 50%;
        top: 50%;
        transform: translate(-50%, -50%);
        color: #ffe1f4;
        font-size: 14px;
        text-shadow:
          0 0 6px rgba(255, 190, 235, 0.9),
          0 0 14px rgba(255, 120, 200, 0.8);
        pointer-events: none;
        animation: popUp 2.4s ease-out forwards;
      }

      @keyframes popUp {
        0% {
          transform: translate(-50%, -50%) scale(0.4);
          opacity: 0;
        }
        15% {
          opacity: 1;
        }
        100% {
          transform: translate(
              calc(-50% + var(--dx, 0px)),
              calc(-50% + var(--dy, -40px))
            )
            scale(1.2);
          opacity: 0;
        }
      }

      /* çˆ±å¿ƒå†…æ–‡æ¡ˆ */
      .name-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -52%);
        font-size: 40px;
        letter-spacing: 0.18em;
        color: #ffe9fb;
        text-shadow:
          0 0 10px rgba(255, 203, 238, 0.9),
          0 0 18px rgba(255, 123, 203, 0.9);
        white-space: nowrap;
      }

      /* æ‰“å¼€å¥–å¡åçš„æ–‡æ¡ˆ */
      .blessing {
        position: absolute;
        bottom: 13vh;
        left: 50%;
        transform: translateX(-50%);
        text-align: center;
        white-space: nowrap;
        font-weight: 600;
        text-shadow:
          0 0 8px rgba(255, 145, 214, 0.8),
          0 0 18px rgba(255, 82, 180, 0.9);
      }

      .blessing-line {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.4em;
        font-size: 20px;
        margin: 0.15em 0;
      }

      .emoji {
        font-size: 18px;
      }

      .text-main {
        color: #ffe9fb;
        letter-spacing: 0.15em;
      }

      .sub {
        font-size: 18px;
        color: #ffb7ef;
        letter-spacing: 0.16em;
      }

      /* åº•éƒ¨å°å­—ï¼ˆå¯é€‰ï¼‰ */
      .footer {
        position: absolute;
        bottom: 3vh;
        width: 100%;
        text-align: center;
        font-size: 10px;
        color: #825d8a;
        letter-spacing: 0.1em;
      }

      /* å°å±é€‚é… */
      @media (max-width: 360px) {
        .heart-wrapper {
          width: 78vw;
        }

        .blessing-line {
          font-size: 18px;
        }

        .sub {
          font-size: 16px;
        }

        .env-greetings-main {
          font-size: 18px;
        }

        .env-greetings-sub {
          font-size: 12px;
        }
      }
    </style>
  </head>
  <body>
    <div class="scene-root">
      <!-- é€šç”¨æµ®åŠ¨å°çˆ±å¿ƒ & LOVE -->
      <div class="float-layer" id="float-layer"></div>

      <!-- ä¿¡å°é¡µé¢ -->
      <section class="screen screen--active" id="screen-envelope">
        <div class="envelope" id="envelope">
          <div class="env-base"></div>
          <div class="env-inner">
            <div class="env-greetings-main">èµ Â· å¶ä½³é¢–</div>
            <div class="env-greetings-sub">æœ‰ä¸€å°çš‡å¸è¯ä¹¦ç»™ä½ </div>
          </div>
          <div class="env-heart-stamp">â¤</div>
          <div class="env-open-tip">
            <span class="env-open-tip-dot"></span>
            <span>ç‚¹å‡»æ¥æ—¨</span>
            <span class="env-open-tip-dot"></span>
          </div>
        </div>
      </section>

      <!-- æ‰“å¼€åçš„çˆ±å¿ƒå¡ç‰‡é¡µé¢ -->
      <section class="screen screen--hidden" id="screen-heart">
        <div class="rain-layer" id="rain-layer"></div>

        <div class="center">
          <div class="heart-wrapper" id="heart-wrapper" aria-hidden="true">
            <svg viewBox="0 0 100 90" preserveAspectRatio="xMidYMid meet">
              <!-- ä½¿ç”¨å¹³æ»‘çš„çˆ±å¿ƒè·¯å¾„ï¼Œæ–¹ä¾¿æè¾¹åŠ¨ç”» -->
              <path
                class="heart-path"
                d="M50 80
                   C 20 60, 8 46, 8 30
                   C 8 18, 17 10, 28 10
                   C 38 10, 45 16, 50 24
                   C 55 16, 62 10, 72 10
                   C 83 10, 92 18, 92 30
                   C 92 46, 80 60, 50 80 Z"
              />
            </svg>
            <div class="name-text">å¶ä½³é¢–</div>
          </div>

          <div class="blessing">
            <div class="blessing-line">
              <span class="emoji">ğŸ®</span>
              <span class="text-main">é™¤å¤•å¿«ä¹</span>
              <span class="emoji">ğŸ§¨</span>
            </div>
            <div class="blessing-line sub">ä¸‡äº‹çš†å¯æœŸ</div>
          </div>
        </div>

        <div class="footer">Happy New Year Â· With love</div>
      </section>
    </div>

    <!-- å…ˆéšä¾¿æ”¾ä¸€é¦–èƒŒæ™¯éŸ³ä¹ï¼šç¤ºä¾‹ä½¿ç”¨å…¬å…±ç¤ºä¾‹éŸ³é¢‘ï¼Œå¯åç»­æ›¿æ¢ -->
    <audio id="bgm" preload="auto" loop>
      <source src="https://samplelib.com/lib/preview/mp3/sample-3s.mp3" type="audio/mpeg" />
    </audio>

    <script>
      /**
       * ç«–æ’å­—ç¬¦é›¨ï¼šåœ¨å±å¹•å®½åº¦èŒƒå›´å†…éšæœºç”Ÿæˆå¤šåˆ—ï¼Œ
       */
      function createRain() {
        const rainLayer = document.getElementById("rain-layer");
        if (!rainLayer) return;

        const charset = ["â¤", "LOVE", "â¤", "â¤"];
        const colCount = 26; // åˆ—æ•°æ›´å¤šï¼Œé›¨æ›´å¯†é›†
        const layerWidth = rainLayer.clientWidth || window.innerWidth;

        for (let i = 0; i < colCount; i++) {
          const col = document.createElement("div");
          col.className = "column";

          const x = (i + Math.random() * 0.8) * (layerWidth / colCount);
          col.style.left = x + "px";

          const length = 24 + Math.floor(Math.random() * 14); // ä¸€åˆ—æ›´é•¿
          let text = "";
          for (let j = 0; j < length; j++) {
            text += charset[Math.floor(Math.random() * charset.length)];
          }
          col.textContent = text;

          const duration = 7 + Math.random() * 7; // 7-14 ç§’ï¼Œç•¥æ…¢ä¸€ç‚¹æ›´æ¸…æ™°
          const delay = -Math.random() * duration; // è´Ÿå»¶è¿Ÿå®ç°äº¤é”™

          // æ¯ä¸€åˆ—å†éšæœºä¸€ç‚¹å°ºå¯¸å’Œé€æ˜åº¦ï¼Œå¢å¼ºå±‚æ¬¡
          const fontSize = 16 + Math.random() * 10; // 16-26px
          const opacity = 0.35 + Math.random() * 0.3;
          col.style.fontSize = fontSize + "px";
          col.style.opacity = opacity.toFixed(2);

          col.style.animationDuration = duration + "s";
          col.style.animationDelay = delay + "s";

          rainLayer.appendChild(col);
        }

        // å½“çª—å£å°ºå¯¸å˜åŒ–æ—¶ï¼Œç®€å•åœ°é‡æ–°æ¸²æŸ“ä¸€æ¬¡åˆ—
        let resizeTimer;
        window.addEventListener("resize", () => {
          clearTimeout(resizeTimer);
          resizeTimer = setTimeout(() => {
            while (rainLayer.firstChild) {
              rainLayer.removeChild(rainLayer.firstChild);
            }
            createRain();
          }, 300);
        });
      }

      /**
       * èƒŒæ™¯å°çˆ±å¿ƒ & LOVEï¼šæ•´å±ç¼“æ…¢å¾€ä¸Šæ¼‚æµ®
       */
      (function createFloatItems() {
        const floatLayer = document.getElementById("float-layer");
        if (!floatLayer) return;

        const count = 110; // æ•°é‡æ›´å¤šä¸€ç‚¹ï¼Œå‡ ä¹é“ºæ»¡æ•´ä¸ªå±å¹•
        const width = floatLayer.clientWidth || window.innerWidth;
        const height = floatLayer.clientHeight || window.innerHeight;

        for (let i = 0; i < count; i++) {
          const el = document.createElement("div");
          el.className = "float-item";
          el.textContent = "â¤";

          const x = Math.random() * width;
          const delay = -Math.random() * 12;
          const duration = 10 + Math.random() * 8;

          // è®©å°çˆ±å¿ƒåœ¨ä»ä¸‹åˆ°ä¸Šæ•´ä¸ªå¯è§†åŒºåŸŸå†…å‡ºç°ï¼Œå¹¶ç”¨ depth æ§åˆ¶æ¸å˜
          const startY = Math.random(); // 0~1 å¯¹åº”ä»åº•éƒ¨åˆ°é¡¶éƒ¨
          el.style.left = x + "px";
          el.style.bottom = -(startY * height * 0.6) + "px";
          el.style.setProperty("--depth", String(startY));

          el.style.animationDuration = duration + "s";
          el.style.animationDelay = delay + "s";

          floatLayer.appendChild(el);
        }
      })();

      /**
       * ç‚¹å‡»ä¿¡å°ï¼šåˆ‡æ¢åˆ°çˆ±å¿ƒå¡ç‰‡ + æ’­æ”¾éŸ³ä¹ + åˆ›å»ºå­—ç¬¦é›¨
       */
      (function setupEnvelope() {
        const envelope = document.getElementById("envelope");
        const screenEnvelope = document.getElementById("screen-envelope");
        const screenHeart = document.getElementById("screen-heart");
        const bgm = document.getElementById("bgm");
        const heartWrapper = document.getElementById("heart-wrapper");

        if (!envelope || !screenEnvelope || !screenHeart) return;

        let opened = false;
        let burstTimer = null;

        // ä»å¤§çˆ±å¿ƒä¸­å¿ƒâ€œè¹¦å‡ºâ€ä¸€åœˆå°çˆ±å¿ƒ
        function createHeartBurst() {
          if (!heartWrapper) return;

          const count = 10;
          for (let i = 0; i < count; i++) {
            const span = document.createElement("span");
            span.className = "heart-pop";
            span.textContent = "â¤";

            // ä»¥åœ†å½¢éšæœºè§’åº¦å‘å¤–æ‰©æ•£
            const angle = (Math.PI * 2 * i) / count + Math.random() * 0.6;
            const distance = 30 + Math.random() * 40;
            const dx = Math.cos(angle) * distance;
            const dy = Math.sin(angle) * distance * -1; // å¤§éƒ¨åˆ†å¾€ä¸Šé£˜

            span.style.setProperty("--dx", dx.toFixed(1) + "px");
            span.style.setProperty("--dy", dy.toFixed(1) + "px");

            span.addEventListener("animationend", () => {
              span.remove();
            });

            heartWrapper.appendChild(span);
          }
        }

        function openCard() {
          if (opened) return;
          opened = true;

          screenEnvelope.classList.remove("screen--active");
          screenEnvelope.classList.add("screen--hidden");

          screenHeart.classList.remove("screen--hidden");
          screenHeart.classList.add("screen--active");

          // åˆå§‹åŒ–å­—ç¬¦é›¨
          createRain();
          // åˆå§‹åŒ–ä¸€ç»„çˆ±å¿ƒçˆ†å¼€æ•ˆæœï¼Œå¹¶ä¸å¿ƒè·³èŠ‚å¥ä¸€èµ·å¾ªç¯
          createHeartBurst();
          burstTimer = setInterval(createHeartBurst, 2400);

          // ç”¨æˆ·äº¤äº’åå°½é‡æ’­æ”¾éŸ³ä¹ï¼ˆè‹¥è¢«æµè§ˆå™¨æ‹¦æˆªä¹Ÿä¸ä¼šæŠ¥é”™ï¼‰
          if (bgm && typeof bgm.play === "function") {
            bgm.play().catch(() => {});
          }
        }

        envelope.addEventListener("click", openCard);
        envelope.addEventListener("touchend", (e) => {
          e.preventDefault();
          openCard();
        });
      })();
    </script>
  </body>
</html>

